<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>개인정보 탐지 대시보드</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
  

<link rel="stylesheet" href="assets/css/common.css">
<link rel="stylesheet" href="assets/page-css/main.page.css"></head>
<body>
  <div class="brandbar" onclick="location.href='main.html'" style="cursor:pointer"><div class="dot"></div> Privacy Monitor</div>
  <div class="pm-container">
    <div class="page-title">개인정보 탐지 대시보드</div>
    <div class="pm-navwrap">
      <nav class="pm-nav" aria-label="주요 메뉴">
        <a href="#" onclick="location.href='detection_details.html'">탐지 현황</a>
        <a href="#" onclick="location.href='source_type.html'">소스별 현황</a>
        <a href="#" onclick="location.href='personal_information_type.html'">개인정보 유형별 현황</a>
        <a href="#" onclick="location.href='account_management.html'">계정관리</a>
      </nav>
    </div>

    <div class="max-w-6xl mx-auto p-4">
    <section class="grid grid-cols-2 gap-3 mb-4">
        <div class="bg-white p-3 rounded shadow">
          <h2 class="font-semibold mb-1 text-sm">탐지 건수 (기간별)</h2>
          <canvas id="chartDetectionsOverTime" height="80"></canvas>
        </div>
        <div class="bg-white p-3 rounded shadow">
          <h3 class="font-semibold mb-1 text-sm">금일 탐지 유형</h3>
          <p class="text-xs text-gray-700 mb-2">총 건수: <strong><span id="todayTotal">0</span></strong></p>
          <table class="min-w-full text-xs">
            <thead><tr class="text-left text-gray-500"><th class="py-1">유형</th><th class="py-1">건수</th></tr></thead>
            <tbody id="todayTypeTbody"></tbody>
          </table>
        </div>
      </section>

      <section class="grid grid-cols-2 gap-3 mb-4">
        <div class="bg-white p-3 rounded shadow">
          <h2 class="font-semibold mb-1 text-sm">사용자별 탐지 빈도 (TOP 5)</h2>
          <canvas id="chartAccountCounts" height="140"></canvas>
        </div>
        <div class="bg-white p-3 rounded shadow flex flex-col items-center">
          <h3 class="font-semibold mb-1 text-sm">소스별 분포</h3>
          <div class="w-52 h-52"><canvas id="chartSourcePie" height="130"></canvas></div>
        </div>
      </section>

      <section class="grid grid-cols-2 gap-3 mb-4">
        <div class="bg-white p-3 rounded shadow">
          <h3 class="font-semibold mb-1 text-sm">탐지 유형별 통계</h3>
          <table class="min-w-full text-xs mb-0">
            <thead><tr class="text-left text-gray-500"><th class="py-1">유형</th><th class="py-1">건수</th><th class="py-1">비율</th></tr></thead>
            <tbody>
              <tr class="border-t"><td class="py-1">전화번호</td><td>30</td><td>40%</td></tr>
              <tr class="border-t"><td class="py-1">이메일</td><td>20</td><td>27%</td></tr>
              <tr class="border-t"><td class="py-1">주민번호</td><td>15</td><td>20%</td></tr>
              <tr class="border-t"><td class="py-1">IP 주소</td><td>10</td><td>13%</td></tr>
            </tbody>
          </table>
        </div>
        <div class="bg-white p-3 rounded shadow">
          <h2 class="font-semibold mb-1 text-sm">탐지 실패</h2>
          <p class="text-xs text-gray-700">총 실패: <strong>3</strong></p>
          <ul class="mt-1 text-xs text-gray-600 space-y-1">
            <li>• 2025-09-20 — 사번: A1023 / secret.pdf (암호화 파일)</li>
            <li>• 2025-09-21 — 사번: A1138 / test.docx (손상 파일)</li>
            <li>• 2025-09-22 — 사번: B2047 / data.xlsx (빈 파일)</li>
          </ul>
        </div>
      </section>
    </div>
  </div>

  <script>
    const detectionsOverTime = [
      { date: "2025-09-18", count: 3 },
      { date: "2025-09-19", count: 7 },
      { date: "2025-09-20", count: 5 },
      { date: "2025-09-21", count: 8 },
      { date: "2025-09-22", count: 4 },
    ];
    const accountCountsRaw = [
      { account: "S0001", count: 22 },
      { account: "A1023", count: 20 },
      { account: "A1138", count: 18 },
      { account: "B2047", count: 12 },
      { account: "B2099", count: 9 },
      { account: "A1200", count: 7 },
    ];
    const accountCounts = accountCountsRaw.sort((a,b)=>b.count-a.count).slice(0,5);

    const sourceStats = [
      { source: "PDF", count: 50 },
      { source: "DOCX", count: 30 },
      { source: "XLSX", count: 22 },
      { source: "TXT", count: 18 },
      { source: "TEXT", count: 25 }
    ];
    const totalSources = sourceStats.reduce((sum, s) => sum + s.count, 0);

    new Chart(document.getElementById("chartDetectionsOverTime"), {
      type: "line",
      data: {
        labels: detectionsOverTime.map(d => d.date),
        datasets: [{ label: "탐지 건수", data: detectionsOverTime.map(d => d.count), fill: true, tension: 0.3 }]
      },
      options: { plugins: { legend: { display: false } } }
    });
    new Chart(document.getElementById("chartAccountCounts"), {
      type: "bar",
      data: { labels: accountCounts.map(a => a.account), datasets: [{ label: "탐지 수", data: accountCounts.map(a => a.count) }] },
      options: { indexAxis: "y", plugins: { legend: { display: false } } }
    });
    new Chart(document.getElementById("chartSourcePie"), {
      type: "pie",
      data: { labels: sourceStats.map(s => s.source), datasets: [{ data: sourceStats.map(s => s.count) }] },
      options: { plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: 11 } } }, datalabels: { color: '#fff', formatter: (v) => ((v/totalSources)*100).toFixed(1)+'%' } } },
      plugins: [ChartDataLabels]
    });

    (function(){
      const todayTypeStats = [
        { type: "전화번호", count: 10 },
        { type: "이메일", count: 8 },
        { type: "주민등록번호", count: 5 },
        { type: "카드번호", count: 3 },
        { type: "IP 주소", count: 2 }
      ];
      const tbody = document.getElementById("todayTypeTbody");
      const totalSpan = document.getElementById("todayTotal");
      const total = todayTypeStats.reduce((a,b)=>a+b.count,0);
      tbody.innerHTML = todayTypeStats.map(r=>`<tr class="border-t"><td class="py-1">${r.type}</td><td>${r.count}</td></tr>`).join('');
      totalSpan.textContent = total;
    })();
  </script>

<script>
/* 로그아웃 버튼 스타일 강제 적용 */
document.addEventListener('DOMContentLoaded', function() {
  const logoutBtn = document.querySelector('.pm-userbox .logout');
  if (logoutBtn) {
    logoutBtn.style.fontSize = '12px';
    logoutBtn.style.fontWeight = '700';
    logoutBtn.style.padding = '6px 8px';
  }
});
</script>

  <!-- 우측 상단 유저 박스 -->
  <div class="pm-userbox" role="group" aria-label="사용자 메뉴">
    <span class="emp" title="사번"><span class="dot" aria-hidden="true"></span> A1023</span>
    <button type="button" class="logout" style="font-size:12px!important;font-weight:700!important;padding:6px 8px!important;font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,'Apple SD Gothic Neo','Noto Sans KR',sans-serif!important;">로그아웃</button>
  </div>

<script>

</script>
</body>
</html>